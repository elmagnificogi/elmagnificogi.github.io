---
layout:     post
title:      "æ­å»ºOneDriveIndexã€æŒ‚è½½SharePoint"
subtitle:   "åŒæµŽ,ä¸–çºªäº’è”"
date:       2021-04-25
author:     "elmagnifico"
header-img: "img/bg5.jpg"
catalog:    true
tags:
    - vps
---

## Foreword

çªç„¶æœ‰äº†ä¸€ä¸ªä¸–çºªäº’è”çš„1T OneDriveï¼Œå¬è¯´è¿˜èƒ½æŒ‚è½½SharePoint 25Tï¼ŒäºŽæ˜¯å°±æ¥æŠ˜è…¾ä¸€ä¸‹çœ‹çœ‹æœ‰ä»€ä¹ˆæ–¹æ¡ˆå¯ä»¥ç”¨ã€‚



- SharePointï¼Œç®€å•è¯´å°±æ˜¯æä¾›äº†ä¸€ä¸ªç«™ç‚¹æœåŠ¡ï¼Œå¹¶ä¸”ç»™äº†éžå¸¸å¤§çš„ç©ºé—´ï¼Œæœ‰çš„å¯èƒ½åœ¨å»ºç«‹ç«™ç‚¹ä»¥åŽç¬¬äºŒå¤©è‡ªåŠ¨å‡çº§åˆ°25Tå®¹é‡ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å¡«æ»¡1Tå®¹é‡ä»¥åŽè‡ªåŠ¨å‡çº§åˆ°25Tï¼Œæ€»è€Œè¨€ä¹‹å°±æ˜¯ç™½å«–



## æŒ‚è½½æ–¹æ¡ˆ

#### Cloudreve

> https://github.com/cloudreve/Cloudreve

Cloudreveæ”¯æŒæœ¬æœºã€ä»Žæœºã€ä¸ƒç‰›ã€é˜¿é‡Œäº‘ OSSã€è…¾è®¯äº‘ COSã€åˆæ‹äº‘ã€OneDrive (åŒ…æ‹¬ä¸–çºªäº’è”ç‰ˆ) ä½œä¸ºå­˜å‚¨ç«¯

- ðŸ“¤ ä¸Šä¼ /ä¸‹è½½ æ”¯æŒå®¢æˆ·ç«¯ç›´ä¼ ï¼Œæ”¯æŒä¸‹è½½é™é€Ÿ
- ðŸ’¾ å¯å¯¹æŽ¥ Aria2 ç¦»çº¿ä¸‹è½½
- ðŸ“š åœ¨çº¿ åŽ‹ç¼©/è§£åŽ‹ç¼©ã€å¤šæ–‡ä»¶æ‰“åŒ…ä¸‹è½½
- ðŸ’» è¦†ç›–å…¨éƒ¨å­˜å‚¨ç­–ç•¥çš„ WebDAV åè®®æ”¯æŒ
- âš¡ æ‹–æ‹½ä¸Šä¼ ã€ç›®å½•ä¸Šä¼ ã€æµå¼ä¸Šä¼ å¤„ç†
- ðŸ—ƒï¸ æ–‡ä»¶æ‹–æ‹½ç®¡ç†
- ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ å¤šç”¨æˆ·ã€ç”¨æˆ·ç»„
- ðŸ”— åˆ›å»ºæ–‡ä»¶ã€ç›®å½•çš„åˆ†äº«é“¾æŽ¥ï¼Œå¯è®¾å®šè‡ªåŠ¨è¿‡æœŸ
- ðŸ‘ï¸â€ðŸ—¨ï¸ è§†é¢‘ã€å›¾åƒã€éŸ³é¢‘ã€æ–‡æœ¬ã€Office æ–‡æ¡£åœ¨çº¿é¢„è§ˆ

~~å¯ä»¥è¯´åŠŸèƒ½éžå¸¸å¼ºæ‚äº†ï¼Œä½†æ˜¯ä¸æ”¯æŒSharePoint æŒ‚è½½~~

æœ€æ–°çš„3.3ç‰ˆæœ¬å¼€å§‹æ”¯æŒSharePointäº†ï¼Œç‰›çš®



æ‰€ä»¥å°±æœ‰äº†ä¸‹é¢çš„é­”æ”¹ç‰ˆæœ¬ï¼Œæ”¯æŒSharePointäº†

> https://github.com/moeYuiYui/Cloudreve/

æ•™ç¨‹åœ¨ä¸‹é¢

> https://www.lizi.tw/web/19826.html



#### YukiDrive

> https://github.com/YukiCoco/YukiDrive

YukiDriveä¸€ä¸ª Onedrive & SharePoint æ–‡ä»¶æµè§ˆç¨‹åºï¼Œæ”¯æŒå›½é™…ç‰ˆå’Œä¸–çºªäº’è”ç‰ˆã€‚åŽç«¯é‡‡ç”¨ .net core 3.1ï¼Œå‰ç«¯ä½¿ç”¨ Vue ï¼Œå‰åŽç«¯åˆ†ç¦»ï¼Œæ— åˆ·æ–°åŠ è½½ã€‚æ— éœ€æ­å»ºè¿è¡ŒçŽ¯å¢ƒï¼Œä¸‹è½½å¹¶é…ç½®å®ŒæˆåŽç›´æŽ¥è¿è¡Œã€‚

ç›®å‰ä¸æ”¯æŒåŠ å¯†å’Œå¤šç”¨æˆ·ã€‚

ä½†æ˜¯ä»–æœ‰æ¼”ç¤ºç«™ï¼Œæ¯”è¾ƒæ–¹ä¾¿çœ‹æ•ˆæžœï¼š

> https://drive.kurisu.moe



#### sharelist

> https://github.com/reruin/sharelist

ShareList æ˜¯ä¸€ä¸ªæ˜“ç”¨çš„ç½‘ç›˜å·¥å…·ï¼Œæ”¯æŒå¿«é€ŸæŒ‚è½½ GoogleDriveã€OneDrive ï¼Œå¯é€šè¿‡æ’ä»¶æ‰©å±•åŠŸèƒ½ã€‚æ‰©å±•ä¹‹åŽå¯ä»¥æŒ‚è½½å¤©ç¿¼äº‘ã€å’Œå½©äº‘ã€è“å¥äº‘ã€æœ¬åœ°æ–‡ä»¶ã€WebDavã€é˜¿é‡Œäº‘ç›˜ã€ç™¾åº¦äº‘ç›˜ç­‰ç­‰

éœ€è¦æ³¨æ„ä»–ä¸æ”¯æŒSharePointçš„æŒ‚è½½ï¼Œä½†æ˜¯æ€»ä½“é›†æˆåº¦æ¯”è¾ƒé«˜ï¼Œè¾ƒä¸ºæ–¹ä¾¿



#### Oneindex

æœ€åˆåŽŸç‰ˆçš„Oneindexæ˜¯è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯è¿˜æœ‰å…¶ä»–å„ç§åŸºäºŽæ­¤çš„ç‰ˆæœ¬



**onedrive-cf-index**

>https://github.com/spencerwooo/onedrive-cf-index

æ¼”ç¤ºç«™ï¼š

> https://storage.spencerwoo.com/

æ•™ç¨‹

> https://gaominn.com/index.php/archives/odcfinedx.html



**oneindex-j**

> https://github.com/jialezi/oneindex-j

æ•™ç¨‹æœ‰ç‚¹è€äº†ï¼Œä½†æ˜¯æ„æ€å·®ä¸å¤š

> https://blog.jialezi.net/?post=157

åŒæ—¶ä¹Ÿæœ‰2ä¸ªæ¼”ç¤ºç«™ï¼ŒéŸ³é¢‘å¯ä»¥ç›´æŽ¥æ’­æ”¾

>https://odrive.azurewebsites.net/odc/
>
>https://od.xkx.me/



#### rclone

> https://rclone.org/

è¿™ä¸ªæ–¹æ¡ˆå¯ä»¥æŒ‚è½½å¾ˆå¤šçŸ¥åç½‘ç›˜

æŒ‚è½½æ•™ç¨‹

> https://www.daniao.org/12259.html



## é­”æ”¹ç‰ˆCloudreveæ­å»º

æˆ‘é€‰æ‹©ä½¿ç”¨é­”æ”¹ç‰ˆCloudreveï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æŽ¥ç”¨æœ€æ–°ç‰ˆ3.3æ¥æ­å»ºï¼Œå‰©ä¸‹çš„éƒ½ç±»ä¼¼

æ­å»ºæµç¨‹éžå¸¸ç®€å•ï¼Œéšä¾¿ä¸Šä¸ªvpsï¼Œç„¶åŽæŒ‰ç…§ä¸‹é¢çš„å¼€å§‹å°±è¡Œäº†

```bash
wget  https://github.com/moeYuiYui/Cloudreve/releases/download/3.2.0/cloudreve_sp_3.2.0_linux_amd64.tar.gz
# è§£åŽ‹ç¨‹åºåŒ…
tar -zxvf cloudreve_sp_3.2.0_linux_amd64.tar.gz
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x ./cloudreve
# å¯åŠ¨ Cloudreve
./cloudreve
```

å¯åŠ¨ä»¥åŽï¼Œå°±èƒ½çœ‹åˆ°å¯¹åº”çš„ç®¡ç†å‘˜è´¦å·å’Œå¯†ç äº†ï¼Œè®°å¾—å®‰å…¨ç»„é‡Œæ‰“å¼€5212çš„ç«¯å£ï¼Œudpå’Œtcpæˆ‘éƒ½æ‰“å¼€äº†

![image-20210425172708936](https://i.loli.net/2021/04/25/3VTpC4lxIU5Qq9f.png)

ç„¶åŽè®¿é—®vpsçš„5212ç«¯å£ï¼Œå³å¯ç™»é™†ï¼Œçœ‹æ•ˆæžœäº†

> https://vps_id:5212



#### SSL

ä½†æ˜¯å¦‚æžœè¦æŒ‚è½½onedriveï¼Œè¿˜éœ€è¦sslã€‚SSLå¯ä»¥ç”³è¯·å…è´¹çš„Let's Encryptï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ç”³è¯·é˜¿é‡Œäº‘çš„å…è´¹sslè¯ä¹¦

> http://elmagnifico.tech/2019/09/05/Https-SSL-Certification/

çŽ°åœ¨é˜¿é‡Œäº‘å¯ä»¥ç›´æŽ¥ç”³è¯·20ä¸ªå…è´¹çš„è¯ä¹¦ï¼Œä½†æ˜¯è¿™20ä¸ªå…è´¹è¯ä¹¦ï¼Œå¦‚æžœæ²¡æœ‰ä½¿ç”¨ï¼Œé‚£ä¹ˆåœ¨æ¯å¹´12æœˆ31æ—¥24ç‚¹å°±ä¼šè‡ªåŠ¨å¤±æ•ˆï¼Œä½†æ˜¯å¦‚æžœä½ è¯ä¹¦åˆ°æœŸäº†ï¼Œè¿˜æœ‰å…è´¹è¯ä¹¦çš„é¢åº¦çš„è¯ï¼Œé‚£ä¹ˆä¹‹å‰çš„è¯ä¹¦å°±å¯ä»¥è‡ªåŠ¨ç»­æœŸã€‚ä¹Ÿå°±æ˜¯è¯´è¦ä½ æ¯å¹´1æœˆ1å·ä»¥åŽé‡æ–°è´­ä¹°20ä¸ªå…è´¹è¯ä¹¦ï¼Œç„¶åŽå°±å¯ä»¥è‡ªåŠ¨ç»­æœŸäº†ã€‚

æœ‰äº†è¯ä¹¦ä»¥åŽï¼Œä¸‹è½½å¯¹åº”çš„nginxç‰ˆæœ¬ï¼Œä¸Šä¼ åˆ°vpsç­‰å¾…ä½¿ç”¨ã€‚



#### nginx

è¿™é‡Œé»˜è®¤ä½¿ç”¨nginxæ¥åå‘ä»£ç†ï¼Œå¦‚æžœä¸éœ€è¦nginxå¯ä»¥ç›´æŽ¥åœ¨Cloudreveçš„åŒç›®å½•ä¸‹ä¿®æ”¹conf.iniï¼Œæ¥æ·»åŠ sslè¯ä¹¦ã€‚

```
[System]
Mode = master
Listen = :5212
SessionSecret = GhXTBH8gasdigjasdjfoiasXbHnj5eUVt0yfUS4Z
HashIDSalt = m1XcBSwscl6Q500mOpUDVasdpfjalsdfjoaisdfVbAja8BIRwgTFfRh

; SSL ç›¸å…³
[SSL]
; SSL ç›‘å¬ç«¯å£
Listen = :443
; è¯ä¹¦è·¯å¾„
CertPath = /root/ssl/fullchain.pem
; ç§é’¥è·¯å¾„
KeyPath = /root/ssl/privkey.key
```

ç„¶åŽé‡æ–°å¯åŠ¨cloudreveï¼Œå°±å¯ä»¥ç”¨httpsç™»é™†äº†ã€‚



ä¸è¿‡å¦‚æžœåŽŸæœ¬ä½¿ç”¨äº†nginxï¼Œé‚£å°±è¦é€šè¿‡å¢žåŠ nginxé…ç½®æ¥åå‘ä»£ç†äº†ã€‚

å‡å¦‚åŽŸæœ¬çš„nginxçš„é…ç½®æ˜¯è¿™æ ·çš„

```bash
server {
    listen 443 ssl http2;
    server_name ä½ çš„åŸŸå;
    root /etc/nginx/html;
    index index.php index.html;
    ssl_certificate /etc/nginx/ssl/ä½ çš„è¯ä¹¦.cer;
    ssl_certificate_key /etc/nginx/ssl/ä½ çš„è¯ä¹¦.key;
    #TLS ç‰ˆæœ¬æŽ§åˆ¶
    ssl_protocols   TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
    ssl_ciphers     'TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+ECDSA+AES128:EECDH+aRSA+AES128:RSA+AES128:EECDH+ECDSA+AES256:EECDH+aRSA+AES256:RSA+AES256:EECDH+ECDSA+3DES:EECDH+aRSA+3DES:RSA+3DES:!MD5';
    ssl_prefer_server_ciphers   on;
    # å¼€å¯ 1.3 0-RTT
    ssl_early_data  on;
    ssl_stapling on;
    ssl_stapling_verify on;
    #add_header Strict-Transport-Security "max-age=31536000";
    #access_log /var/log/nginx/access.log combined;
    location /cb24 {
        proxy_redirect off;
        proxy_pass http://127.0.0.1:11234;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $http_host;
    }
}

```

é‚£ä¹ˆå°±éœ€è¦å†å¢žåŠ ä¸€ä¸ªlocationï¼Œåœ¨ä¸Šé¢çš„serverä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç 

```bash
    location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://127.0.0.1:5212;

    # å¦‚æžœæ‚¨è¦ä½¿ç”¨æœ¬åœ°å­˜å‚¨ç­–ç•¥ï¼Œè¯·å°†ä¸‹ä¸€è¡Œæ³¨é‡Šç¬¦åˆ é™¤ï¼Œå¹¶æ›´æ”¹å¤§å°ä¸ºç†è®ºæœ€å¤§æ–‡ä»¶å°ºå¯¸
    client_max_body_size 20000m;
    }
```

è¿™é‡Œå°±æ˜¯å°†è®¿é—®æ ¹ç›®å½•/çš„ï¼Œéƒ½è½¬å‘ç»™æœ¬åœ°5212ç«¯å£ã€‚

å½“ç„¶è¿™é‡Œå¯ä»¥éšæ„ä¿®æ”¹/ï¼Œæ”¹æˆä½ æƒ³è¦çš„å³å¯ã€‚

ç„¶åŽè¯•ä¸€ä¸‹ç”¨httpsè®¿é—®ï¼Œçœ‹æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ç™»é™†è®¿é—®ã€‚

å¤§æ¦‚çŽ‡ä¼šæç¤ºä½ å½“å‰URLå’Œè®¾ç½®ä¸­çš„ä¸åŒï¼Œè¦ä½ ä¿®æ”¹ï¼Œé‚£å°±å¦‚ä¸‹æ“ä½œå³å¯ï¼š

æŽ§åˆ¶é¢æ¿/å‚æ•°è®¾ç½®/ç«™ç‚¹ä¿¡æ¯/ä¿®æ”¹ç«™ç‚¹URLä¸ºå¸¦httpsçš„



#### å­˜å‚¨ç­–ç•¥

æŽ¥ç€å°±æ˜¯åœ¨å­˜å‚¨ç­–ç•¥ä¸­æ·»åŠ onedrive

![image-20210425220740178](https://i.loli.net/2021/04/25/3FOSI6yWu9XPjb7.png)

é€‰æ‹©onedrive

![image-20210425220819592](https://i.loli.net/2021/04/25/t8NVKmRJPqb5FAv.png)

è¿™é‡Œå¯ä»¥çœ‹åˆ°ä»¥åŠç»™ä½ äº†æ¯ä¸€æ­¥å¦‚ä½•åšï¼ŒæŒ‰ç…§å¯¹åº”çš„æ“ä½œåŽ»å»ºç«‹ä¸€ä¸ªåº”ç”¨ï¼Œç„¶åŽèŽ·å–åˆ°åº”ç”¨ç¨‹åºIDå’Œå®¢æˆ·ç«¯å¯†ç ã€‚

è¿™é‡Œè¿˜è¦æ³¨æ„ä¸€ä¸‹ï¼Œå…¶å®žè¿˜æœ‰ä¸€ä¸ªAPIæƒé™æ·»åŠ ï¼Œåº”è¯¥åœ¨ç¬¬5æ­¥ä»¥åŽï¼ˆè²Œä¼¼ä¸æ·»åŠ ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼‰ï¼Œè¿™é‡Œæ²¡æœ‰è¯´ï¼Œæˆ‘è¡¥å……ä¸€ä¸‹

![image-20210425221202989](https://i.loli.net/2021/04/25/sXob18cahzlMUHZ.png)

é€šè¿‡ä¸Šè¿°æ“ä½œæ·»åŠ æƒé™ï¼Œä¸€å…±éœ€è¦æ‰‹åŠ¨æ·»åŠ 3ä¸ªæƒé™

- Files.Read
- Files.Read.All
- offline_access

å‰©ä¸‹çš„æƒé™æ˜¯è‡ªåŠ¨æ·»åŠ çš„ï¼Œæ·»åŠ å®ŒæˆåŽå¦‚å›¾æ‰€ç¤º

![image-20210425221339831](https://i.loli.net/2021/04/25/hNlra4pAdc5GJin.png)

è¿™é‡Œå®Œæˆä»¥åŽï¼Œå‰©ä¸‹å°±æ˜¯é€‰æ‹©ä½ å¯¹åº”çš„OneDriveè´¦å·ç±»åž‹äº†ã€‚

è¿™é‡Œå¾ˆå¤šåœ°æ–¹æ²¡è¯´æ˜Žï¼Œæˆ‘è¯¦ç»†è¯´ä¸€ä¸‹.

å¦‚æžœä½ æ˜¯**å›½é™…ç‰ˆ**çš„OneDriveï¼Œé‚£ä¹ˆåˆšæ‰çš„è¿™ä¸ªåº”ç”¨ä¹Ÿå¿…é¡»ç”¨**å›½é™…ç‰ˆ**çš„æŸä¸ªè´¦å·æœ¬æ¥å»ºç«‹ï¼Œç„¶åŽè¿™é‡Œé€‰æ‹©çš„ä¹Ÿæ˜¯**å›½é™…ç‰ˆ**ï¼Œç„¶åŽä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œåˆ°æŽˆæƒçš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæç¤ºä½ ä½¿ç”¨**å›½é™…ç‰ˆ**çš„è´¦å·ç™»é™†ï¼Œä½ å¯ä»¥åˆ‡æ¢æˆå…¶ä»–çš„**å›½é™…ç‰ˆ**è´¦å·ï¼Œè¿™æ ·è¿™ä¸ªç­–ç•¥é‡Œä½¿ç”¨çš„å°±æ˜¯åˆšæ‰æŽˆæƒçš„é‚£ä¸ªè´¦å·çš„OneDriveç©ºé—´ã€‚



å¦‚æžœä½ æ˜¯**ä¸–çºªäº’è”**çš„OneDriveï¼Œé‚£ä¹ˆåˆšæ‰çš„è¿™ä¸ªåº”ç”¨ä¹Ÿå¿…é¡»ç”¨**ä¸–çºªäº’è”**çš„æŸä¸ªè´¦å·æœ¬æ¥å»ºç«‹ï¼Œç„¶åŽè¿™é‡Œé€‰æ‹©çš„ä¹Ÿæ˜¯**ä¸–çºªäº’è”**ï¼Œç„¶åŽä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œåˆ°æŽˆæƒçš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæç¤ºä½ ä½¿ç”¨**ä¸–çºªäº’è”**çš„è´¦å·ç™»é™†ï¼Œä½ å¯ä»¥åˆ‡æ¢æˆå…¶ä»–çš„**ä¸–çºªäº’è”**è´¦å·ï¼Œè¿™æ ·è¿™ä¸ªç­–ç•¥é‡Œä½¿ç”¨çš„å°±æ˜¯åˆšæ‰æŽˆæƒçš„é‚£ä¸ªè´¦å·çš„OneDriveç©ºé—´ã€‚



å»ºç«‹åº”ç”¨çš„è´¦å·æ‰€å±žå’ŒæŽˆæƒçš„è´¦å·æ‰€å±žå¿…é¡»æ˜¯åŒä¸€ä¸ªç»„ç»‡çš„ï¼Œæ¯”å¦‚å›½é™…ã€ä¸–çºªäº’è”ï¼Œå¦åˆ™ä¼šç›´æŽ¥æç¤ºä½ æ‰¾ä¸åˆ°å¯¹åº”çš„åº”ç”¨ID

```
ç™»å½•
æŠ±æ­‰ï¼Œç™»å½•æ—¶é‡åˆ°é—®é¢˜ã€‚

AADSTS700016: Application with identifier '211f238d-4057-4134-9d3d-69731c63e3a0' was not found in the directory 'e20c4664-0335-46c1-8043-3c1b77fac445'. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You may have sent your authentication request to the wrong tenant.
```

![image-20210425222026833](https://i.loli.net/2021/04/25/rTt5ZHfg3dX6uSO.png)



å¦‚æžœæ­£å¸¸ï¼Œå°±ä¼šæç¤ºä½ æŽˆæƒæˆåŠŸï¼Œç„¶åŽå°±å¯ä»¥æ¬¢å¿«çš„ä¸Šä¼ äº†ã€‚



#### ç”¨æˆ·å­˜å‚¨ç­–ç•¥

è¦æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æžœä¸ä¿®æ”¹é»˜è®¤ç”¨æˆ·ç­–ç•¥ï¼Œé‚£ä¹ˆç”¨æˆ·ä¸Šä¼ æ˜¯ç›´æŽ¥ä¸Šä¼ åˆ°äº†vpsçš„æœ¬æœºä¸Šã€‚

![image-20210425222231396](https://i.loli.net/2021/04/25/2UBH4j6wxE8mVzX.png)

éœ€è¦åœ¨ç”¨æˆ·ç»„ä¸­ä¿®æ”¹å­˜å‚¨ç­–ç•¥ï¼Œç”±äºŽæ˜¯å…è´¹ç‰ˆï¼Œå•ç”¨æˆ·ç»„åªæ”¯æŒå•å­˜å‚¨ç­–ç•¥ã€‚

è¦å¤šå­˜å‚¨ç­–ç•¥ï¼Œéœ€è¦proç‰ˆæœ¬ã€‚proç‰ˆæœ¬çœ‹ä¸‹é¢è¯´æ˜Ž

> https://forum.cloudreve.org/d/1587



#### æµ‹è¯•

ç”¨æ³¨å†Œç”¨æˆ·ç™»é™†ï¼Œç„¶åŽéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥çœ‹åˆ°å¯¹åº”OneDriveç½‘ç›˜çš„uploadä¸‹æŒ‰ç…§å¹´æœˆæ—¥çš„ç›®å½•ä¸­å¤šå‡ºäº†ä¸€ä¸ªæ–‡ä»¶ã€‚



æ³¨æ„ï¼Œå¦‚æžœä½ ç›´æŽ¥é€šè¿‡pcåŒæ­¥çš„OneDriveï¼Œå¾€è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ·»åŠ æ–‡ä»¶ï¼Œå¹¶ä¸ä¼šæ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œä¹Ÿä¸ä¼šæ˜¾ç¤ºåœ¨cloudreveç³»ç»Ÿä¸­ã€‚ä¸€å®šæ˜¯é€šè¿‡cloudreveä¸Šä¼ çš„æ–‡ä»¶æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥



## å…¶ä»–æ²¡æœ‰åº”ç”¨æ³¨å†Œæƒé™çš„è§£å†³åŠžæ³•

å¦‚æžœå•ç‹¬åªæœ‰ä¸€ä¸ªä¸–çºªäº’è”çš„è´¦å·ï¼Œè¿˜ä¸å…·æœ‰ç®¡ç†å‘˜æƒé™ï¼Œæ— æ³•åˆ›å»ºåº”ç”¨ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸‹é¢çš„é”™è¯¯æç¤º

```
æ— è®¿é—®æƒé™
æ‘˜è¦
ä¼šè¯ ID
e9f656ffd01a4b4bb0e6412d8721c2c2
èµ„æº ID
ä¸å¯ç”¨
æ‰©å±•
Microsoft_AAD_IAM
å†…å®¹
ActiveDirectoryMenuBlade
é”™è¯¯ä»£ç 
403
```

![image-20210425222925689](https://i.loli.net/2021/04/25/zGjIcaeMFHAmRd2.png)

å¦‚æžœæ˜¯è¿™ç§æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å•†ä¸šè¯•ç”¨ï¼Œæ¥æ–°å»ºä¸€ä¸ªä¸–çºªäº’è”çš„è´¦å·ï¼Œå¹¶ä¸”æ­¤è´¦å·ä¼šå…·æœ‰åˆ›å»ºAPIçš„æƒé™ï¼Œç”¨è¿™ä¸ªè´¦å·åˆ›å»ºåº”ç”¨ä»¥åŽï¼ŒæŽˆæƒç»™æ— æ³•åˆ›å»ºçš„è´¦å·ä½¿ç”¨å³å¯

> https://signup.microsoftonline.cn/Signup?OfferId=e1ff4ab7-2e5e-429d-a860-1cf9b5249f95&dl=O365_BUSINESS_PREMIUM&culture=zh-CN&Country=CN&ali=1#0



## æŒ‚è½½SharePoint

æŒ‚è½½å‰å…ˆä¿è¯å¯ä»¥æ­£å¸¸å»ºç«‹ä¸–çºªäº’è”çš„å­˜å‚¨ç­–ç•¥ï¼Œå¦åˆ™åŽé¢éƒ½æ— æ³•å·¥ä½œã€‚

é¦–å…ˆæ˜¯æ–°å»ºä¸€ä¸ªSharePointç«™ç‚¹ï¼Œé€šè¿‡ä¸–çºªäº’è”ç™»é™†ã€‚

1. ç‚¹å‡»SharePoint
2. åˆ›å»ºç½‘ç«™
3. å›¢é˜Ÿç½‘ç«™
4.  èµ·ä¸€ä¸ªä¸é‡å¤çš„åå­—ï¼Œç„¶åŽè®°å½•ä¸‹æ¥ç«™ç‚¹åœ°å€ï¼Œéžå¸¸é‡è¦

![image-20210425230045512](https://i.loli.net/2021/04/25/cR4eSPXL6yjtJ1x.png)

åŽé¢å°±éšæ„ä¸‹ä¸€æ­¥ï¼Œç›´åˆ°å®Œæˆå³å¯ã€‚



æ­¤æ—¶å›žåˆ°ä¹‹å‰çš„OneDriveå­˜å‚¨ç­–ç•¥ä¸­ï¼Œç„¶åŽç”¨åŒæ ·çš„åº”ç”¨idå’Œå¯†ç å†æ–°å»ºä¸€æ¡å­˜å‚¨ç­–ç•¥ï¼Œå¹¶ä¸”é€šè¿‡ç¼–è¾‘é…ç½®åˆ‡æ¢åˆ°ä¸“å®¶æ¨¡å¼ï¼Œç„¶åŽè®°å½•ä¸‹æ¥æ­¤æ—¶çš„AccessKey / åˆ·æ–°Token

![image-20210425230710753](https://i.loli.net/2021/04/25/xiE1GSF9XYvy5Ok.png)

å›žåˆ°vpsï¼Œæˆ‘ä»¬éœ€è¦èŽ·å–SharePointçš„siteidã€‚

é€šè¿‡ä¸‹é¢å°å·¥å…·æ¥èŽ·å–siteid

```
wget https://github.com/moeYuiYui/Cloudreve/releases/download/3.2.0/siteid.tar.gz
tar -xzf siteid.tar.gz
./siteid
```

å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š

```
[root@C20210319238684 ~]# ./siteid

==================================================
          å¾®è½¯SharePoint SiteIDèŽ·å–å°å·¥å…·
==================================================

å›½é™…ç‰ˆè¯·è¾“å…¥ï¼š1 ä¸–çºªäº’è”è¯·è¾“å…¥ï¼š2 : 
2
ä½ é€‰æ‹©äº†ä¸–çºªäº’è”ç‰ˆã€‚
è¯·è¾“å…¥ åº”ç”¨ç¨‹åºï¼ˆå®¢æˆ·ç«¯ï¼‰ID : 
8b81ebfb-711b-40d5-aff2-3274asdfdc7
åº”ç”¨ç¨‹åºï¼ˆå®¢æˆ·ç«¯ï¼‰ID : 8b81ebfb-711b-40d5-aff2-3274asdfdc7
è¯·è¾“å…¥ å®¢æˆ·ç«¯å¯†ç  : 
Rxasdfasdfasdfw4asdfasdf2lTA~R~
å®¢æˆ·ç«¯å¯†ç  : Rxasdfasdfasdfw4asdfasdf2lTA~R~
è¯·è¾“å…¥ OneDrive é‡å®šå‘åœ°å€ : 
https://ä½ çš„vps/api/v3/callback/onedrive/auth
OneDrive é‡å®šå‘åœ°å€ : https://ä½ çš„vps/api/v3/callback/onedrive/auth
è¯·è¾“å…¥ åˆ·æ–°Tokenï¼ˆRefresh_Tokenï¼‰ : 
0.AAAAZEYM4jUDwUaAQzwbd_rERfvrgYsbcdVAr_IydN0nDccBAGE.AQABAAAAAADF8uhbdqMKTqrrFtoyDhmYPbqB0p1qnTlTU1Fm-ZWGBm5Ret_hjaQnAYp6jS-xsdcORE_o-LtF7lVEIdccjUB5EWhakYgkgs_dv95A5qvL1QbZP4ln58jw5RHGoqCwqLHFmopARpJ_DfEsYO9QP-v0T3rfwyzlbXCVO9Rh4ARyjn-797dVj5FXrTVeFDHKLe3nM4i0EET1Ckv_YW375Y1OHsdAb5f13m3M9Zwm-Ov5NZN-asdfasdfadsgqwejjtroqweior
...asdfasdf
asdfasdfasdf
è¯·è¾“å…¥ä½ çš„SharePointåŸŸå xxx.sharepoint.comæˆ–è€…xxx.sharepoint.cn : 
universitytongji.sharepoint.cn
ä½ çš„SharePointåŸŸå : universitytongji.sharepoint.cn
è¯·è¾“å…¥ä½ çš„SharePointç½‘ç«™åœ°å€ sites/xxxæˆ–è€…teams/xxx : 
teams/asdfa
ä½ çš„SharePointç½‘ç«™åœ°å€ : teams/asdfa
ä½ è¾“å…¥çš„SharePointå®Œæ•´åŸŸåä¸º:
https://universitytongji.sharepoint.cnteams/asdfa
ä½ çš„SiteIDä¸º:
universitytongji.sharepoint.cn,f0f1c212-01dasd2-4a43-asdbad4-97112asdfasdf53f,deasdf1c35-9ae4-4c66-a716asd
```

æ‹¿åˆ°äº†ä»¥åŽå°±å¯ä»¥åˆæˆæˆ‘ä»¬SharePointçš„serveråœ°å€äº†

```
https://microsoftgraph.chinacloudapi.cn/v1.0/sites/{siteid}
å®žé™…çš„åƒè¿™æ ·ï¼š
https://microsoftgraph.chinacloudapi.cn/v1.0/sites/universitytongji.sharepoint.cn,f0f1c212-0asdfasdfgbad4-97112345853f,deb1asdfasdfa6-a716-eecaeaa79f87
```

æ›¿æ¢åŽŸæ¥çš„serveråœ°å€

![image-20210425231221203](https://i.loli.net/2021/04/25/Dg2BJZhzG9UbQ4a.png)

ç„¶åŽä¿å­˜å³å¯ï¼Œç»™ç”¨æˆ·åˆ‡æ¢åˆ°SharePointç­–ç•¥ï¼Œä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”çš„ç«™ç‚¹ä¸­æ·»åŠ äº†è¿™ä¸ªæ–‡ä»¶ã€‚



## Summary

å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼ŒæŒºéº»çƒ¦çš„ï¼Œä½†æ˜¯æ€»ç®—æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼Œç™½å«–äº†ä¸€ä¸ªè¶…å¤§ç½‘ç›˜ï¼Œè€Œä¸”ä¸–çºªäº’è”åˆ°å›½å†…çš„é€Ÿåº¦æ¯”è¾ƒå¥½ã€‚Onedriveæ¯”è¾ƒç¨³å®šä¸€äº›ï¼Œå¤šæ•°æƒ…å†µä¸‹éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œå›½é™…çš„æ›´æ˜¯ç¨³ï¼Œè€Œæ ¡å‹ä¹‹ç±»çš„æœ‰æ¦‚çŽ‡ç¿»è½¦ã€‚Sharepointå’Œæ ¡å‹Onedriveç”±äºŽå…¶ç¨³å®šæ€§å’Œç§å¯†æ€§ä¸å¤Ÿé«˜ï¼Œæœ¬è´¨ä¸Šç®¡ç†å‘˜å¯ä»¥å®¡æ ¸ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ‰€ä»¥è¦é•¿ä¹…ç”¨è¿˜æ˜¯å¤šæŽ‚é‡æŽ‚é‡ã€‚



## Quote

> http://www.dwf135.cn/1589.html
>
> https://shikey.com/2020/12/25/sharepoint-to-cloudreve.html
>
> https://docs.cloudreve.org/getting-started/install
>
> https://docs.cloudreve.org/getting-started/config
>
> https://gaominn.com/index.php/archives/odcfinedx.html

